/*! ctp-assemble 07-09-2017 */

function dotOver(e){d3.select(e).transition().duration(200).attr("r",7)}function dotOut(e){d3.select(e).transition().duration(200).attr("r",4)}function barOver(e){d3.select(e).transition().duration(200).style("stroke-width",4)}function barOut(e){d3.select(e).transition().duration(200).style("stroke-width",1)}function redrawDots(){d3.selectAll(".dimple-marker").attr("r",4).attr("fill",function(e){return d3.select(this).attr("stroke")}).style("stroke-width",4)}function p(e){return d3.format(".2p")(e)}function yr(e){return d3.timeFormat("%Y")(e)}function span(e){return"<span>"+e+"</span>"}function horizTip(e){return span(e.y+": "+p(e.xValue))}function horizTip2(e){return span(e.y+": "+e.xValue)}function vertTip(e){return span(e.x+": "+p(e.yValue))}function horizGroupTip(e){return span(e.cy+", "+e.aggField[0]+": "+p(e.xValue))}function vertGroupTip(e){return span(e.cx+", "+e.aggField[0]+": "+p(e.yValue))}function trendTip(e){return span(yr(e.x)+": "+p(e.yValue))}function trendGroupTip(e){return span(("All"===e.aggField[0]?"Goal":e.aggField[0])+", "+yr(e.x)+": "+p(e.yValue))}function trendTipThous(e){return span(yr(e.x)+": "+d3.format(",")(e.yValue))}function pieTip(e){return span(e.aggField[0]+": "+d3.format(",")(e.pValue))}var d3map=function(){function e(e){e.each(function(e){d=d3.select(this),h(this,e)})}function t(e,t,n){var r=e.datum().properties.name,o=u[r],a=void 0===o?"N/A":t(o);return(n?'<span class="tip-label">'+r+": </span>":"")+a}function r(e){return 0===e.i?e.generatedLabels[e.i].replace("NaN% to","Less than").replace("$NaN to","Less than").replace("NaN to","Less than"):e.i===e.genLength-1?("More than "+e.generatedLabels[e.genLength-1]).replace(" to NaN%","").replace(" to $NaN","").replace(" to NaN",""):e.generatedLabels[e.i]}var o,a,l,i,c,d,s,p,u={},h=function(t,n){o=o||parseInt(d.style("width")),a=1*o,l=d3.geoMercator().scale(1).translate([0,0]),i=d3.geoPath().projection(l);var r=.95/(((s=i.bounds(n))[1][0]-s[0][0])/o),p=[(o-r*(s[1][0]+s[0][0]))/2,(a-r*(s[1][1]+s[0][1]))/2];l.scale(r).translate(p);(c=d3.select(t).append("svg").attr("width",o).attr("height",a)).append("g").selectAll("path").data(n.features).enter().append("path").attr("d",i).attr("class","polygon");e.draw()};return e.draw=function(){var t=parseInt(d.style("width")),n=1*t;this.width(t).height(n);var r=.95/((s[1][0]-s[0][0])/o),p=[(o-r*(s[1][0]+s[0][0]))/2,(a-r*(s[1][1]+s[0][1]))/2];return l.scale(r).translate(p),i=d3.geoPath().projection(l),c.attr("width",t).attr("height",n).selectAll(".polygon").attr("d",i),e},e.color=function(t,r,o){if(!arguments.length)return e;r=r||d3.schemePurples[5],n=r.length,t.forEach(function(e){e.value=+e.value});var a=d3.nest().key(function(e){return e.name}).entries(t),l=a.map(function(e){return e.values[0].value}),i=ss.ckmeans(l,n).map(function(e){return e[0]}).slice(1);p=d3.scaleThreshold().domain(i).range(r),a.forEach(function(e){u[e.key]=e.values[0].value});d.selectAll(".polygon").attr("fill",function(e){var t=u[e.properties.name];return void 0===t?"#bbb":p(t)});return e},e.tip=function(n,r,o){n=n||"d3-tip",r=r||d3.format("");var a=d3.tip().attr("class",n);return d.selectAll(".polygon").call(a).on("mouseover",function(){a.html(t(d3.select(this),r,o)),a.show()}).on("mouseout",a.hide),e},e.legend=function(t,n,o,a){a=a||"legendQuant",t=t||d3.format(""),n=n||20,o=o||20;var l=d.append("div").style("position","absolute").style("left",n+"px").style("bottom",o+"px").style("pointer-events","none").append("svg"),i=l.append("g").attr("class",a),c=d3.legendColor().labelFormat(t).labels(r).useClass(!1).scale(p);i.call(c);var s=i.node().getBBox();return l.attr("width",s.width).attr("height",s.height),e},e.width=function(t){return arguments.length?(o=t,e):o},e.height=function(t){return arguments.length?(a=t,e):a},e},pink=new dimple.color("#992156"),ltblue=new dimple.color("#739DD0"),dkblue=new dimple.color("#2f588b"),green=new dimple.color("#359957"),scale5=[new dimple.color("#b92868"),new dimple.color("#b04f86"),new dimple.color("#a16ba4"),new dimple.color("#8984c5"),new dimple.color("#5d9be6"),new dimple.color("#555")],scale3=[new dimple.color("#b92868"),new dimple.color("#a16ba4"),new dimple.color("#5d9be6"),new dimple.color("#555")],demoscale=[new dimple.color("#992156"),new dimple.color("#9d526c"),new dimple.color("#9e7682"),new dimple.color("#2f588b"),new dimple.color("#50678f"),new dimple.color("#6a7792"),new dimple.color("#818896"),new dimple.color("#359957"),new dimple.color("#5e9a6d"),new dimple.color("#7d9a83")],choroscale=["#e8e5ed","#d8b6c5","#c6879e","#b15879","#992156"];